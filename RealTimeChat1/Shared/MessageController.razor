@using Microsoft.AspNetCore.SignalR.Client;
@inject NavigationManager NavigationManager

@code {
	// Receive перенести в mesengerContainer, но  для этого надо решить проблему с контекстом Хаба
	private HubConnection hubConnection;
	private string userNameInput;
	private string messageInput;
	private List<string> messages = new List<string>();

	protected override async Task OnInitializedAsync()
	{
		hubConnection = new HubConnectionBuilder().WithUrl(NavigationManager.ToAbsoluteUri("/chat")).Build();
		hubConnection.On<string, string>("ReceiveMessage", (userName, message) =>
		{
			messages.Add($"{userName}: {message}");
			StateHasChanged();
		});
		await hubConnection.StartAsync();
	}

	async Task Send()
	=> await hubConnection.SendAsync("SendMessage", userNameInput, messageInput);


}
